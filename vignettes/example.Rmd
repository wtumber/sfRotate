---
title: "example"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{example}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```
### Importing packages
Here we also set sf_use_s2 to false, which is required to enable `sf::st_crop()`.
```{r}
library(sfRotate)
#library(sf)
#library(rnaturalearth)
#library(rnaturalearthdata)

sf::sf_use_s2(FALSE)
```
 
We use this angle when shearing and rotating the data to output the desired shape. This value does not have to be the same for each function, but the output shape will not be a diamond.
```{r}
angle_to_tilt <- pi/4
```
We import an sf object from `rnaturalearth`.
```{r}
# import data
world <- rnaturalearth::ne_countries(scale="medium",returnclass="sf")
```
### Creating the bboundary box
We use `create_boundary_shape` to create the boundary box. This function will return with the message:

> If you are creatinga square you might have wanted radius :  
> 70.7106781186548 

This is because the radius defines the distance to the square vertex, which is not actually the minimum length in the square.

We can convert this shape to a standard `st_bbox` to crop the sf layer. To make mutations to the box shape we must cast it to type `"POINT"`, then summarise and recast as a `"POLYGON"`.
```{r}
box_shape <- create_boundary_shape(vertices = 4, radius = 50, transpose = c(0,50))

boundary <- sf::st_bbox(box_shape)

outline <- box_shape %>%
  sf::st_cast("POINT") %>% # cast to point before making any changes
  shear_data(shear_angle=angle_to_tilt) %>%
  rotate_data(rotate_angle=angle_to_tilt/2) %>%
  dplyr::summarise(geometry=st_combine(geometry)) %>%
  sf::st_cast("POLYGON")
```

``` {r}
# Cut world map using boundary box
data <- world %>%
  sf::st_crop(boundary)%>%
  shear_data(shear_angle=angle_to_tilt) %>%
  rotate_data(rotate_angle=angle_to_tilt/2)%>%
  transpose_data(y_add = 2)

data2 <- world %>%
  crop_circle(boundary,angle=(pi/24))%>%
  shear_data(shear_angle=angle_to_tilt)
```



